# Runtime Logs System - WebLabs-MobIDE

## Overview

The WebLabs-MobIDE repository includes a comprehensive runtime logs system that tracks blocked content, security events, and workflow execution status during CI/CD operations.

## Purpose

The runtime logs system addresses persistent GitHub Actions artifact upload errors by ensuring required log files are always present at expected locations.

## File Structure

### Required Files
- `blocked.jsonl` - JSON Lines format tracking blocked content events
- `blocked.md` - Markdown report summarizing blocked content and workflow status

### Expected Locations
The system creates these files in multiple locations for maximum compatibility:

1. **Primary Location**: `/home/runner/work/_temp/runtime-logs/`
   - This is where GitHub Actions typically expects the files
   - Used for system-level artifact uploads

2. **Secondary Location**: `/tmp/runtime-logs/`
   - Backup location for workflows that use /tmp
   - Standard temporary directory location

3. **Workspace Location**: `${{ github.workspace }}/_temp/runtime-logs/`
   - Repository-relative location
   - Used by workspace-specific workflows

## Workflows That Create Runtime Logs

### Primary Creators
1. **`runtime-logs-creator.yml`** - Dedicated workflow for creating runtime logs
   - Triggered on workflow completion, push, and PR events
   - Creates files in all three locations
   - Provides comprehensive verification

2. **`integration-verification.yml`** - Frontend-backend integration verification
   - Creates runtime logs as part of integration testing
   - Includes integration status in blocked.md report

3. **`CI.yml`** - Continuous Integration workflow
   - Creates runtime logs during CI execution
   - Includes build and test status in reports

### File Content Format

#### blocked.jsonl
```json
[]
```
Empty JSON array indicating no blocked content detected.

#### blocked.md
```markdown
# Blocked Content Report

No blocked content detected during workflow execution.

## Summary
- Total requests: 0 blocked
- Status: Clean execution
- Workflow: [Workflow Name]
- Generated: [UTC Timestamp]

## Categories
- Malicious URLs: 0
- Security violations: 0
- Policy violations: 0
- Content filtering: 0

---
Generated by WebLabs-MobIDE [Workflow] Pipeline
```

## Artifact Upload Strategy

### Multiple Path Strategy
To ensure artifact upload success, the system:

1. **Creates files in all possible locations** where GitHub Actions might look
2. **Uploads from multiple paths** in upload-artifact steps
3. **Uses `if-no-files-found: warn`** to prevent workflow failures
4. **Provides verification steps** to confirm file creation

### Example Upload Configuration
```yaml
- name: Upload runtime logs
  uses: actions/upload-artifact@v4
  with:
    name: runtime-logs-${{ github.run_number }}
    path: |
      /tmp/runtime-logs/blocked.jsonl
      /tmp/runtime-logs/blocked.md
      /home/runner/work/_temp/runtime-logs/blocked.jsonl
      /home/runner/work/_temp/runtime-logs/blocked.md
    if-no-files-found: warn
    retention-days: 30
```

## Troubleshooting

### Common Issues

1. **"No files were found" Error**
   - **Cause**: Files not created before upload step
   - **Solution**: Ensure runtime logs creation step runs before upload

2. **Path Mismatch**
   - **Cause**: Different workflows expecting files in different locations
   - **Solution**: Create files in all possible locations

3. **Permission Issues**
   - **Cause**: Insufficient permissions to create directories
   - **Solution**: Use `mkdir -p` to create parent directories

### Verification Commands

```bash
# Check if files exist in expected locations
ls -la /home/runner/work/_temp/runtime-logs/
ls -la /tmp/runtime-logs/

# Verify file content
cat /home/runner/work/_temp/runtime-logs/blocked.jsonl
head -5 /home/runner/work/_temp/runtime-logs/blocked.md
```

## Integration with WebLabs-MobIDE Standards

The runtime logs system is compliant with WebLabs-MobIDE Copilot Coding Standards:

- **Production-ready**: All workflows generate meaningful logs
- **ARM64 focused**: Logs include ARM64 compatibility status
- **Security integrated**: Tracks security scanning results
- **CI/CD optimized**: Designed for automated pipeline execution

## Maintenance

### Adding New Workflows
When creating new workflows that upload artifacts:

1. Add runtime logs creation step
2. Include both path locations in uploads
3. Use `if-no-files-found: warn` parameter
4. Include workflow-specific content in blocked.md

### Monitoring
- Runtime logs are retained for 30 days
- Each workflow run creates uniquely named artifacts
- Verification steps provide real-time status during execution

This system ensures reliable artifact uploads and provides comprehensive visibility into workflow execution and security status.